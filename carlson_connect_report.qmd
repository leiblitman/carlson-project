---
title: "Understanding Tucker Carlson's Audience"
subtitle: "Beliefs, Attitudes, and the Effects of an AI-Delivered Factual Intervention — Connect Sample (Pilot)"
date: today
format:
  html:
    toc: true
    toc-depth: 3
    toc-title: "Table of Contents"
    theme: flatly
    code-fold: true
    code-tools: true
    embed-resources: true
    fig-width: 8
    fig-height: 5
    fig-dpi: 150
execute:
  warning: false
  message: false
  echo: false
---

```{r}
#| label: setup
#| include: false

library(tidyverse)
library(kableExtra)
library(scales)
library(cluster)

# ── Shared theme ──────────────────────────────────────────────────────────────
theme_report <- function() {
  theme_minimal(base_size = 12) +
    theme(
      plot.title       = element_text(face = "bold", size = 13),
      plot.subtitle    = element_text(color = "grey40", size = 11),
      axis.title       = element_text(size = 11),
      panel.grid.minor = element_blank(),
      strip.text       = element_text(face = "bold"),
      legend.position  = "bottom"
    )
}

pal_main <- c("#2c7bb6", "#d7191c", "#1a9641", "#fdae61", "#756bb1")

# ── Load data ─────────────────────────────────────────────────────────────────
df <- read_csv(
  "data/raw/result_persuasion_Connect_2.17.26.csv",
  show_col_types = FALSE
)

n_total    <- nrow(df)
n_complete <- sum(df[["Interview Status"]] == "Completed", na.rm = TRUE)
df_c       <- df |> filter(`Interview Status` == "Completed")

# ── Column helpers ────────────────────────────────────────────────────────────
fcol <- function(pattern, data = df, suffix = NULL) {
  nms <- grep(pattern, names(data), value = TRUE, perl = TRUE)
  if (!is.null(suffix)) nms <- grep(suffix, nms, value = TRUE, fixed = TRUE)
  nms
}

# ── Pre/post paired t-test helper ────────────────────────────────────────────
paired_stats <- function(pre_cols, post_cols, labels, data = df_c) {
  map2_dfr(pre_cols, post_cols, function(p, q) {
    pre_v  <- suppressWarnings(as.numeric(data[[p]]))
    post_v <- suppressWarnings(as.numeric(data[[q]]))
    ok     <- !is.na(pre_v) & !is.na(post_v)
    n      <- sum(ok)
    if (n < 3) {
      return(tibble(n = n, pre = NA, post = NA, diff = NA, d = NA, p = NA))
    }
    diffs <- post_v[ok] - pre_v[ok]
    tst   <- t.test(post_v[ok], pre_v[ok], paired = TRUE)
    tibble(
      n    = n,
      pre  = round(mean(pre_v[ok]),  1),
      post = round(mean(post_v[ok]), 1),
      diff = round(mean(diffs),      1),
      d    = round(mean(diffs) / sd(diffs), 2),
      p    = tst$p.value
    )
  }) |>
    mutate(Item = labels) |>
    relocate(Item)
}

sig_star <- function(p) {
  case_when(
    p < .001 ~ "***",
    p < .01  ~ "**",
    p < .05  ~ "*",
    p < .10  ~ "†",
    TRUE     ~ ""
  )
}

fmt_pp_table <- function(tbl, caption = NULL) {
  tbl |>
    mutate(
      `Pre M` = pre,
      `Post M` = post,
      `Δ`      = case_when(diff > 0 ~ paste0("+", diff), TRUE ~ as.character(diff)),
      `d`      = d,
      `p`      = paste0(format(round(p, 3), nsmall = 3), " ", sig_star(p))
    ) |>
    select(Item, n, `Pre M`, `Post M`, `Δ`, d, p) |>
    kbl(caption = caption, align = c("l","c","c","c","c","c","l")) |>
    kable_styling(bootstrap_options = c("striped","hover","condensed"),
                  full_width = FALSE, position = "left") |>
    footnote(
      general = "All scales: 0–100. d = Cohen's d for paired differences. † p<.10, * p<.05, ** p<.01, *** p<.001.",
      general_title = ""
    )
}
```

::: {.callout-warning}
## Pilot Data — Treat All Results as Preliminary
This report covers the **Connect panel sample**: **`r n_complete` completed responses** out of `r n_total` total, collected on February 17, 2026.
Results should be treated as exploratory pending full-scale data collection.
:::

::: {.callout-note}
## Key Difference from the PrimePanels Sample
The Connect sample was recruited through CloudResearch's Connect platform, which draws from a broader, more politically diverse pool than PrimePanels.
Panel-provided demographic information (age, gender, race, income, education, party) is used where available and supplemented by in-survey responses.
**Post-treatment batteries use question numbers Q17–Q21** (versus Q18–Q22 in PrimePanels).
:::

---

# 1 Study Overview

This study examines the beliefs, attitudes, and media consumption patterns of Tucker Carlson viewers using an AI-delivered factual intervention. The survey flow mirrors the PrimePanels study:

1. **Pre-treatment measures** — media engagement, conspiracy beliefs, foreign policy attitudes, and feelings toward Israel (Q1–Q12).
2. **AI-delivered conversation** — structured factual dialogue about Israel-related topics (experimental manipulation).
3. **Post-treatment measures** — same attitude batteries administered again (Q17–Q21), plus open-ended reflections (Q22–Q23).

| Domain | Pre | Post |
|---|---|---|
| Carlson credibility | Q8 | Q17 |
| Foreign policy views | Q9 | Q18 |
| Feelings toward Israel / Jewish people | Q10 | Q19 |
| Carlson's Israel commentary | Q11 | Q20 |
| Israel policy positions | Q12 | Q21 |

---

# 2 Sample Characteristics

```{r}
#| label: demo-prep

# Connect provides panel-level demographic variables as system columns.
# Use fcol() to find each one by pattern to avoid encoding issues with
# curly apostrophes and other special characters in column names.

age_col    <- fcol("^Age \\(")[1]
sex_col    <- fcol("^Sex \\(")[1]
gender_col <- fcol("^Gender \\(")[1]
race_col   <- fcol("^Race \\(")[1]
eth_col    <- fcol("^Ethnicity \\(")[1]
educ_col   <- fcol("^Education \\(")[1]
party_col  <- fcol("^Political Party \\(")[1]
inc_col    <- fcol("^Household Income \\(")[1]
emp_col    <- fcol("^Employment Status \\(")[1]
tc_col     <- fcol("^Tucker Carlson Content \\(")[1]

# Survey-asked ideology and state (not available as panel variables)
ideo_col   <- fcol("^\\(29\\) Do you consider yourself politically")[1]
state_col  <- fcol("^\\(34\\) In what state")[1]

demo <- df_c |>
  mutate(
    age_num   = suppressWarnings(as.numeric(.data[[age_col]])),
    age_group = cut(age_num,
                    breaks = c(17, 29, 39, 49, 59, 69, 79, 120),
                    labels = c("18–29","30–39","40–49","50–59","60–69","70–79","80+")),
    sex       = .data[[sex_col]],
    gender    = .data[[gender_col]],
    race      = .data[[race_col]],
    ethnicity = .data[[eth_col]],
    education = .data[[educ_col]],
    party     = .data[[party_col]],
    income    = .data[[inc_col]],
    ideology  = if (!is.na(ideo_col))  .data[[ideo_col]]  else NA_character_,
    state     = if (!is.na(state_col)) .data[[state_col]] else NA_character_,
    tc_rel    = .data[[tc_col]]
  ) |>
  select(age_num, age_group, sex, gender, race, ethnicity,
         education, party, income, ideology, state, tc_rel)
```

## 2.1 Age Distribution

```{r}
#| label: fig-age
#| fig-height: 3.5
#| fig-cap: "Age distribution of Connect respondents (panel-provided)"

p_age_hist <- ggplot(demo |> filter(!is.na(age_num)), aes(x = age_num)) +
  geom_histogram(binwidth = 5, fill = "#2c7bb6", color = "white") +
  geom_vline(aes(xintercept = median(age_num, na.rm = TRUE)),
             color = "#d7191c", linetype = "dashed", size = 1) +
  annotate("text",
           x = median(demo$age_num, na.rm = TRUE) + 1,
           y = Inf, vjust = 2, hjust = 0,
           label = paste0("Median = ", median(demo$age_num, na.rm = TRUE)),
           color = "#d7191c", fontface = "bold", size = 3.5) +
  labs(title = "Age Distribution", subtitle = "n = completed respondents",
       x = "Age (years)", y = "Count") +
  theme_report()

print(p_age_hist)
```

## 2.2 Demographics Overview

```{r}
#| label: fig-demo
#| fig-height: 10
#| fig-cap: "Demographic profile of Connect completed respondents"

demo_long <- bind_rows(
  demo |> count(Category = as.character(age_group), Variable = "Age Group"),
  demo |> count(Category = sex,       Variable = "Sex at Birth"),
  demo |> count(Category = race,      Variable = "Race"),
  demo |> count(Category = party,     Variable = "Party"),
  demo |> count(Category = income,    Variable = "Household Income"),
  demo |> count(Category = education, Variable = "Education")
) |>
  filter(!is.na(Category)) |>
  group_by(Variable) |>
  mutate(
    pct      = n / sum(n),
    Category = fct_reorder(Category, n)
  ) |>
  ungroup() |>
  mutate(Variable = factor(Variable, levels = c(
    "Age Group", "Sex at Birth", "Race",
    "Party", "Household Income", "Education"
  )))

ggplot(demo_long, aes(x = Category, y = pct)) +
  geom_col(fill = "#2c7bb6", width = 0.7) +
  geom_text(aes(label = paste0(n, " (", percent(pct, 1), ")")),
            hjust = -0.1, size = 3) +
  scale_y_continuous(labels = percent, expand = expansion(mult = c(0, 0.45))) +
  coord_flip() +
  facet_wrap(~Variable, scales = "free", ncol = 2) +
  labs(
    title    = "Sample Demographics",
    subtitle = paste0("Connect completed respondents (n = ", n_complete, ")"),
    x = NULL, y = NULL
  ) +
  theme_report()
```

```{r}
#| label: fig-ideology
#| fig-height: 3
#| fig-cap: "Self-reported political ideology (survey-asked)"

if (!is.na(ideo_col)) {
  demo |>
    count(ideology) |>
    filter(!is.na(ideology)) |>
    mutate(pct = n / sum(n), ideology = fct_reorder(ideology, n)) |>
    ggplot(aes(x = ideology, y = pct)) +
    geom_col(fill = "#d7191c", width = 0.7) +
    geom_text(aes(label = paste0(n, " (", percent(pct, 1), ")")),
              hjust = -0.1, size = 3.2) +
    scale_y_continuous(labels = percent, expand = expansion(mult = c(0, 0.3))) +
    coord_flip() +
    labs(title = "Political Ideology", x = NULL, y = NULL) +
    theme_report()
}
```

```{r}
#| label: tbl-demo-summary
#| tbl-cap: "Summary of sample demographics (Connect)"

summarise_top <- function(var) {
  demo |>
    count(.data[[var]]) |>
    filter(!is.na(.data[[var]])) |>
    arrange(desc(n)) |>
    mutate(row = paste0(.data[[var]], " — ", n, " (", percent(n / sum(n), 1), ")")) |>
    pull(row)
}

# Age summary
age_summary <- paste0(
  "Median = ", median(demo$age_num, na.rm = TRUE),
  " yrs (range: ", min(demo$age_num, na.rm = TRUE),
  "–", max(demo$age_num, na.rm = TRUE), ")"
)

tibble(
  Characteristic = c(
    "**N completed**",
    "**Age**",
    "**Sex at Birth**",
    "**Race**",
    "**Political Party** (panel)",
    "**Household Income**",
    "**Education**"
  ),
  `Top Category / Summary` = c(
    as.character(n_complete),
    age_summary,
    summarise_top("sex")[1],
    summarise_top("race")[1],
    summarise_top("party")[1],
    summarise_top("income")[1],
    summarise_top("education")[1]
  )
) |>
  kbl(escape = FALSE) |>
  kable_styling(bootstrap_options = c("striped","hover","condensed"),
                full_width = FALSE, position = "left")
```

## 2.3 Relationship with Tucker Carlson's Content

The Connect platform pre-screened participants using their existing Tucker Carlson viewership habits.

```{r}
#| label: tbl-tc-relationship
#| tbl-cap: "Tucker Carlson content relationship (pre-screening variable)"

demo |>
  count(tc_rel) |>
  filter(!is.na(tc_rel)) |>
  arrange(desc(n)) |>
  mutate(
    `%`     = percent(n / sum(n), 1),
    tc_rel  = str_wrap(tc_rel, 60)
  ) |>
  rename(`Relationship with Tucker Carlson Content` = tc_rel) |>
  kbl() |>
  kable_styling(bootstrap_options = c("striped","hover","condensed"),
                full_width = TRUE)
```

---

# 3 Tucker Carlson Engagement

## 3.1 Viewing Frequency and Israel Familiarity

```{r}
#| label: fig-engagement
#| fig-height: 4
#| fig-cap: "Viewing frequency and familiarity with Carlson's Israel commentary"

freq_col <- fcol("^\\(3\\) How often do you watch")[1]
fam_col  <- fcol("^\\(4\\) How familiar are you")[1]

freq_data <- df |>
  count(response = .data[[freq_col]]) |>
  filter(!is.na(response)) |>
  mutate(pct = n / sum(n), response = fct_reorder(response, n),
         panel = "Viewing Frequency")

fam_data <- df |>
  count(response = .data[[fam_col]]) |>
  filter(!is.na(response)) |>
  mutate(pct = n / sum(n), response = fct_reorder(response, n),
         panel = "Familiarity with Israel Views")

bind_rows(freq_data, fam_data) |>
  ggplot(aes(x = response, y = pct, fill = panel)) +
  geom_col(width = 0.7, show.legend = FALSE) +
  geom_text(aes(label = paste0(n, " (", percent(pct, 1), ")")),
            hjust = -0.1, size = 3.2) +
  scale_y_continuous(labels = percent, expand = expansion(mult = c(0, 0.3))) +
  scale_fill_manual(values = c("#2c7bb6", "#1a9641")) +
  coord_flip() +
  facet_wrap(~panel, scales = "free") +
  labs(title = "Tucker Carlson Engagement",
       subtitle = paste0("All respondents (N = ", n_total, ")"),
       x = NULL, y = NULL) +
  theme_report()
```

## 3.2 Commentator Credibility Ratings

```{r}
#| label: fig-commentators
#| fig-height: 4
#| fig-cap: "Mean 'should be listened to' ratings (0 = ignored, 100 = listened to)"

comm_cols   <- fcol("^\\(2\\.[0-9]\\).*- Value$")
comm_labels <- c("Tucker Carlson", "Cenk Uygur", "Ben Shapiro",
                 "Hasan Piker", "Scott Jennings")

comm_means <- map2_dfr(comm_cols, comm_labels, function(col, lab) {
  vals <- suppressWarnings(as.numeric(df[[col]]))
  tibble(
    Commentator = lab,
    Mean = round(mean(vals, na.rm = TRUE), 1),
    SD   = round(sd(vals, na.rm = TRUE),   1),
    N    = sum(!is.na(vals))
  )
})

comm_means |>
  arrange(Mean) |>
  mutate(Commentator = fct_reorder(Commentator, Mean),
         color = ifelse(Commentator == "Tucker Carlson", "#d7191c", "#2c7bb6")) |>
  ggplot(aes(x = Commentator, y = Mean, color = color)) +
  geom_segment(aes(xend = Commentator, y = 0, yend = Mean), size = 1.2) +
  geom_point(size = 5) +
  geom_errorbar(aes(ymin = Mean - SD/sqrt(N), ymax = Mean + SD/sqrt(N)),
                width = 0.2, color = "grey50") +
  geom_text(aes(label = Mean), vjust = -1.2, fontface = "bold",
            size = 3.8, color = "black") +
  scale_y_continuous(limits = c(0, 110), breaks = seq(0, 100, 25)) +
  scale_color_identity() +
  coord_flip() +
  labs(title = "Commentator Credibility Ratings",
       subtitle = "0 = should be ignored  |  100 = should be listened to",
       x = NULL, y = "Mean Rating (0–100)") +
  theme_report()
```

## 3.3 Why They Watch Tucker Carlson

```{r}
#| label: tbl-why-watch
#| tbl-cap: "Open-ended responses: Why do you watch or listen to Tucker Carlson? (selected)"

why_col <- fcol("^\\(5\\) Why do you watch or listen")[1]

df |>
  select(response = all_of(why_col)) |>
  filter(!is.na(response), nchar(trimws(response)) > 5) |>
  slice_head(n = 12) |>
  mutate(response = str_trunc(response, 200)) |>
  rename(`Participant Response` = response) |>
  kbl() |>
  kable_styling(bootstrap_options = c("striped","hover","condensed"),
                full_width = TRUE) |>
  column_spec(1, width = "95%")
```

---

# 4 Baseline Beliefs and Attitudes

## 4.1 Conspiracy and Fringe Beliefs

```{r}
#| label: fig-conspiracy
#| fig-height: 5
#| fig-cap: "Distribution of conspiracy/fringe belief endorsement (1–5 scale)"

con_cols <- fcol("^\\(7\\.[0-9]\\).*- Code$")
con_labels <- c(
  "Vaccines are dangerous\nfor children",
  "The moon landing\nwas probably staged",
  "Jeffrey Epstein was\na Mossad agent",
  "Government hiding\nevidence of alien contact",
  "The 2020 election\nwas stolen from Trump"
)

con_data <- map2_dfr(con_cols, con_labels, function(col, lab) {
  tibble(item = lab, value = suppressWarnings(as.numeric(df[[col]])))
}) |>
  filter(!is.na(value)) |>
  mutate(value = factor(value, levels = 1:5,
                        labels = c("1\nStr. Disagree","2","3\nNeutral","4","5\nStr. Agree")))

con_data |>
  count(item, value) |>
  group_by(item) |>
  mutate(pct = n / sum(n)) |>
  ungroup() |>
  ggplot(aes(x = value, y = pct, fill = value)) +
  geom_col(width = 0.7, show.legend = FALSE) +
  geom_text(aes(label = percent(pct, 1)), vjust = -0.4, size = 3) +
  scale_y_continuous(labels = percent, expand = expansion(mult = c(0, 0.2))) +
  scale_fill_manual(values = c("#2c7bb6","#74add1","#ffffbf","#f46d43","#d73027")) +
  facet_wrap(~item, ncol = 3) +
  labs(title = "Conspiracy and Fringe Belief Endorsement",
       subtitle = "Connect panel (pilot sample)",
       x = NULL, y = "Proportion of respondents") +
  theme_report()
```

## 4.2 Foreign Policy Views (Pre-Treatment)

```{r}
#| label: fig-fp-baseline
#| fig-height: 4.5
#| fig-cap: "Baseline foreign policy attitude distributions (0–100 slider)"

fp_pre_cols <- fcol("^\\(9\\.[0-9]\\).*- Value$")
fp_labels   <- c(
  "Russia provoked by\nNATO & West",
  "Israel & AIPAC have\ntoo much influence",
  "Should cut all\nforeign funding"
)

fp_data <- map2_dfr(fp_pre_cols, fp_labels, function(col, lab) {
  tibble(item = lab, value = suppressWarnings(as.numeric(df[[col]])))
}) |> filter(!is.na(value))

fp_data |>
  ggplot(aes(x = value)) +
  geom_histogram(binwidth = 10, fill = "#2c7bb6", color = "white") +
  geom_vline(
    data = fp_data |> group_by(item) |> summarise(m = mean(value)),
    aes(xintercept = m), color = "#d7191c", linetype = "dashed", size = 1
  ) +
  geom_text(
    data = fp_data |> group_by(item) |> summarise(m = mean(value)),
    aes(x = m, y = Inf, label = paste0("M = ", round(m, 1))),
    vjust = 2, hjust = -0.1, color = "#d7191c", fontface = "bold", size = 3.5
  ) +
  scale_x_continuous(limits = c(0, 100), breaks = c(0, 25, 50, 75, 100)) +
  facet_wrap(~item) +
  labs(title = "Foreign Policy Baseline Attitudes",
       subtitle = "0 = Strongly Disagree  |  100 = Strongly Agree",
       x = NULL, y = "Count") +
  theme_report()
```

## 4.3 Feelings Toward Israel and Jewish People (Pre-Treatment)

```{r}
#| label: fig-therm-baseline
#| fig-height: 4
#| fig-cap: "Baseline feeling thermometer ratings (0 = Extremely Unfavorable, 100 = Extremely Favorable)"

therm_pre_cols <- fcol("^\\(10\\.[0-9]\\).*- Value$")
therm_labels   <- c("Israeli People", "Jewish People", "State of Israel")

therm_data <- map2_dfr(therm_pre_cols, therm_labels, function(col, lab) {
  tibble(item = lab, value = suppressWarnings(as.numeric(df[[col]])))
}) |> filter(!is.na(value))

therm_summary <- therm_data |>
  group_by(item) |>
  summarise(M = round(mean(value), 1), SD = round(sd(value), 1),
            Md = round(median(value), 1), N = n())

therm_data |>
  ggplot(aes(x = value, fill = item)) +
  geom_density(alpha = 0.6, color = "white") +
  geom_vline(data = therm_summary, aes(xintercept = M, color = item),
             linetype = "dashed", size = 1, show.legend = FALSE) +
  scale_x_continuous(limits = c(0, 100), breaks = c(0, 25, 50, 75, 100)) +
  scale_fill_manual(values = pal_main[1:3], name = NULL) +
  scale_color_manual(values = pal_main[1:3]) +
  labs(title = "Feeling Thermometers: Israel and Jewish People",
       subtitle = "Dashed lines = group means",
       x = "Thermometer (0 = Unfavorable → 100 = Favorable)", y = "Density") +
  theme_report()
```

```{r}
therm_summary |>
  kbl(caption = "Feeling thermometer summary statistics (pre-treatment)") |>
  kable_styling(bootstrap_options = c("striped","hover","condensed"),
                full_width = FALSE, position = "left")
```

---

# 5 Experimental Conditions

```{r}
#| label: tbl-conditions
#| tbl-cap: "Distribution of experimental conditions (Block Randomizer)"

block_col <- fcol("Block Randomizer 1 \\(Selected Blocks\\)")

if (length(block_col) > 0) {
  df |>
    count(Condition = .data[[block_col[1]]]) |>
    filter(!is.na(Condition)) |>
    mutate(`%` = percent(n / sum(n), 1)) |>
    kbl() |>
    kable_styling(bootstrap_options = c("striped","hover","condensed"),
                  full_width = FALSE, position = "left")
} else {
  tibble(Note = "Block randomizer column not found — condition information unavailable.") |>
    kbl() |> kable_styling(full_width = FALSE)
}
```

---

# 6 Pre- to Post-Treatment Attitude Changes

> **Note:** In the Connect survey, post-treatment batteries use question numbers Q17–Q21 (one lower than in the PrimePanels survey).

All scales are 0–100.

## 6.1 Credibility of Tucker Carlson

```{r}
#| label: tbl-cred
#| tbl-cap: "Tucker Carlson credibility: pre (Q8) vs. post (Q17)"

cred_pre_cols  <- fcol("^\\(8\\.[0-9]\\).*- Value$")
cred_post_cols <- fcol("^\\(17\\.[0-9]\\).*- Value$")
cred_labels <- c(
  "Trusts his foreign policy analysis",
  "He almost always gets the facts right",
  "His predictions are usually accurate",
  "Covers important topics others ignore",
  "Effectively challenges mainstream narratives",
  "He often gets things wrong"
)

cred_tbl <- paired_stats(cred_pre_cols, cred_post_cols, cred_labels)
fmt_pp_table(cred_tbl, "Tucker Carlson Credibility (0–100 sliders)")
```

## 6.2 Foreign Policy Views

```{r}
#| label: tbl-fp
#| tbl-cap: "Foreign policy views: pre (Q9) vs. post (Q18)"

fp_post_cols <- fcol("^\\(18\\.[0-9]\\).*- Value$")
fp_pp_labels <- c(
  "Russia was provoked by NATO and the West",
  "Israel and AIPAC have too much influence over America",
  "We should cut all funding to foreign countries"
)

fp_tbl <- paired_stats(fp_pre_cols, fp_post_cols, fp_pp_labels)
fmt_pp_table(fp_tbl, "Foreign Policy Views (0–100 sliders)")
```

## 6.3 Feelings Toward Israel and Jewish People

```{r}
#| label: tbl-therm
#| tbl-cap: "Feeling thermometers: pre (Q10) vs. post (Q19)"

therm_post_cols <- fcol("^\\(19\\.[0-9]\\).*- Value$")
therm_pp_labels <- c("Israeli people", "Jewish people", "The State of Israel")

therm_tbl <- paired_stats(therm_pre_cols, therm_post_cols, therm_pp_labels)
fmt_pp_table(therm_tbl, "Feeling Thermometers (0–100)")
```

## 6.4 Tucker Carlson's Israel Commentary

```{r}
#| label: tbl-tc-israel
#| tbl-cap: "Perceptions of Tucker Carlson's Israel commentary: pre (Q11) vs. post (Q20)"

tc_pre_cols  <- fcol("^\\(11\\.[0-9]\\).*- Value$")
tc_post_cols <- fcol("^\\(20\\.[0-9]\\).*- Value$")
tc_labels <- c(
  "His commentary on Israel is accurate and fair",
  "He asks the right questions about America's relationship with Israel",
  "He is too critical of Israel",
  "He understands the Middle East better than most commentators"
)

tc_tbl <- paired_stats(tc_pre_cols, tc_post_cols, tc_labels)
fmt_pp_table(tc_tbl, "Tucker Carlson's Israel Commentary (0–100 sliders)")
```

## 6.5 Israel Policy Positions

```{r}
#| label: tbl-israel-policy
#| tbl-cap: "Israel policy views: pre (Q12) vs. post (Q21)"

ip_pre_cols  <- fcol("^\\(12\\.[0-9]\\).*- Value$")
ip_post_cols <- fcol("^\\(21\\.[0-9]\\).*- Value$")
ip_labels <- c(
  "The U.S.–Israel relationship benefits the United States",
  "Israel has a legitimate right to exist as a Jewish state",
  "Israel generally acts morally in its self-defense",
  "The U.S. should reduce military aid to Israel"
)

ip_tbl <- paired_stats(ip_pre_cols, ip_post_cols, ip_labels)
fmt_pp_table(ip_tbl, "Israel Policy Views (0–100 sliders)")
```

## 6.6 Summary: All Pre/Post Changes

```{r}
#| label: fig-forest
#| fig-height: 8
#| fig-cap: "All pre/post mean changes with approximate 95% confidence intervals. Red = significant (p < .05), orange = marginal (p < .10), grey = non-significant."

all_pre_cols  <- c(cred_pre_cols,  fp_pre_cols,  therm_pre_cols,  tc_pre_cols,  ip_pre_cols)
all_post_cols <- c(cred_post_cols, fp_post_cols, therm_post_cols, tc_post_cols, ip_post_cols)
all_labels    <- c(cred_labels,    fp_pp_labels, therm_pp_labels, tc_labels,    ip_labels)
all_domains   <- c(
  rep("Carlson Credibility",  length(cred_labels)),
  rep("Foreign Policy",       length(fp_pp_labels)),
  rep("Feeling Thermometers", length(therm_pp_labels)),
  rep("Carlson on Israel",    length(tc_labels)),
  rep("Israel Policy",        length(ip_labels))
)

forest_data <- paired_stats(all_pre_cols, all_post_cols, all_labels) |>
  mutate(
    domain = all_domains,
    sig    = case_when(p < .05 ~ "p < .05", p < .10 ~ "p < .10", TRUE ~ "n.s."),
    se     = ifelse(!is.na(d) & d != 0, abs(diff / d) / sqrt(n), NA),
    lo     = diff - 1.96 * se,
    hi     = diff + 1.96 * se,
    Item   = fct_rev(factor(Item, levels = rev(unique(Item))))
  )

forest_data |>
  ggplot(aes(x = diff, y = Item, color = sig)) +
  geom_vline(xintercept = 0, linetype = "dashed", color = "grey60") +
  geom_errorbarh(aes(xmin = lo, xmax = hi), height = 0.3, size = 0.8) +
  geom_point(size = 3.5) +
  scale_color_manual(
    values = c("p < .05" = "#d7191c", "p < .10" = "#fdae61", "n.s." = "#aaaaaa"),
    name = "Significance"
  ) +
  facet_grid(domain ~ ., scales = "free_y", space = "free_y") +
  labs(
    title    = "Pre → Post Mean Changes Across All Outcome Domains",
    subtitle = "Points = mean change; bars = approximate 95% CI",
    x        = "Mean Change (Post − Pre)",
    y        = NULL
  ) +
  theme_report() +
  theme(strip.text.y = element_text(angle = 0, hjust = 0))
```

---

# 7 Audience Segmentation

```{r}
#| label: clustering-prep

cluster_cols <- c(
  fcol("^\\(7\\.[0-9]\\).*- Code$"),
  fcol("^\\(9\\.[0-9]\\).*- Value$"),
  fcol("^\\(10\\.[0-9]\\).*- Value$"),
  fcol("^\\(11\\.[0-9]\\).*- Value$"),
  fcol("^\\(12\\.[0-9]\\).*- Value$")
)

clust_raw <- df |>
  select(all_of(cluster_cols)) |>
  mutate(across(everything(), ~suppressWarnings(as.numeric(.x))))

clust_mat <- clust_raw |>
  mutate(across(everything(),
                ~ifelse(is.na(.x), median(.x, na.rm = TRUE), .x))) |>
  as.matrix()

clust_scaled <- apply(clust_mat, 2, function(x) {
  rng <- range(x, na.rm = TRUE)
  if (diff(rng) == 0) return(rep(0, length(x)))
  (x - rng[1]) / diff(rng)
})

set.seed(42)
sil_scores <- map_dbl(2:5, function(k) {
  km <- kmeans(clust_scaled, centers = k, nstart = 25, iter.max = 100)
  ss <- silhouette(km$cluster, dist(clust_scaled))
  mean(ss[, 3])
})

best_k    <- which.max(sil_scores) + 1L
km_final  <- kmeans(clust_scaled, centers = best_k, nstart = 50, iter.max = 100)
```

```{r}
#| label: fig-silhouette
#| fig-height: 3.5
#| fig-cap: "Silhouette scores by number of clusters (higher = better fit)"

tibble(k = 2:5, silhouette = sil_scores) |>
  ggplot(aes(x = k, y = silhouette)) +
  geom_line(color = "#2c7bb6", size = 1.2) +
  geom_point(size = 4, color = "#2c7bb6") +
  geom_point(data = tibble(k = best_k, silhouette = max(sil_scores)),
             size = 6, shape = 21, color = "#d7191c", fill = NA, stroke = 2) +
  scale_x_continuous(breaks = 2:5) +
  labs(title = "Silhouette Analysis for Optimal Cluster Count",
       subtitle = paste0("Best k = ", best_k, " (circled)"),
       x = "Number of Clusters (k)", y = "Mean Silhouette Score") +
  theme_report()
```

```{r}
#| label: fig-cluster-pca
#| fig-height: 5
#| fig-cap: "Audience segments visualized via PCA (first two principal components)"

pca_res <- prcomp(clust_scaled, center = TRUE, scale. = FALSE)
pca_df  <- as_tibble(pca_res$x[, 1:2]) |>
  mutate(cluster = factor(km_final$cluster))
var_exp <- round(summary(pca_res)$importance[2, 1:2] * 100, 1)

pca_df |>
  ggplot(aes(x = PC1, y = PC2, color = cluster, shape = cluster)) +
  stat_ellipse(alpha = 0.15, aes(fill = cluster), geom = "polygon", type = "norm") +
  geom_point(size = 3, alpha = 0.8) +
  scale_color_manual(values = pal_main[1:best_k], name = "Cluster") +
  scale_fill_manual(values  = pal_main[1:best_k], name = "Cluster") +
  scale_shape_manual(values = c(16, 17, 15, 18)[1:best_k], name = "Cluster") +
  labs(
    title    = paste0("Audience Segments (k = ", best_k, ")"),
    subtitle = paste0("PC1 = ", var_exp[1], "% variance; PC2 = ", var_exp[2], "%"),
    x = paste0("PC1 (", var_exp[1], "%)"),
    y = paste0("PC2 (", var_exp[2], "%)")
  ) +
  theme_report()
```

```{r}
#| label: tbl-cluster-profiles
#| tbl-cap: "Cluster mean profiles on key attitude dimensions"

cluster_item_labels <- c(
  "Vaccines dangerous (1–5)", "Moon landing staged (1–5)",
  "Epstein/Mossad (1–5)", "Alien contact hidden (1–5)",
  "2020 election stolen (1–5)",
  "Russia provoked by NATO (0–100)", "Israel/AIPAC too influential (0–100)",
  "Cut all foreign funding (0–100)",
  "Israeli people thermometer (0–100)", "Jewish people thermometer (0–100)",
  "State of Israel thermometer (0–100)",
  "Carlson Israel commentary accurate (0–100)",
  "Asks right questions on US-Israel (0–100)",
  "Too critical of Israel (0–100)", "Understands Middle East (0–100)",
  "US-Israel benefits US (0–100)", "Israel right to exist (0–100)",
  "Israel acts morally (0–100)", "Reduce military aid (0–100)"
)

used_labels <- cluster_item_labels[seq_along(cluster_cols)]

as_tibble(clust_mat) |>
  setNames(used_labels) |>
  mutate(cluster = factor(km_final$cluster)) |>
  group_by(cluster) |>
  summarise(across(everything(), ~round(mean(.x, na.rm = TRUE), 1)), n = n()) |>
  pivot_longer(-c(cluster, n), names_to = "Item", values_to = "Mean") |>
  pivot_wider(names_from = cluster, values_from = Mean, names_prefix = "Cluster ") |>
  kbl() |>
  kable_styling(bootstrap_options = c("striped","hover","condensed"),
                full_width = FALSE, position = "left") |>
  pack_rows("Conspiracy Beliefs", 1, 5) |>
  pack_rows("Foreign Policy", 6, 8) |>
  pack_rows("Feeling Thermometers", 9, 11) |>
  pack_rows("Carlson on Israel", 12, 15) |>
  pack_rows("Israel Policy", 16, 19)
```

---

# 8 Qualitative Themes

## 8.1 Has Tucker Changed Their Views on Israel?

```{r}
#| label: tbl-influence
#| tbl-cap: "Has Tucker Carlson's commentary influenced your views on Israel? (Q13)"

inf_col <- fcol("^\\(13\\) Has Tucker Carlson")[1]

df |>
  count(Response = .data[[inf_col]]) |>
  filter(!is.na(Response)) |>
  mutate(`%` = percent(n / sum(n), 1)) |>
  kbl() |>
  kable_styling(bootstrap_options = c("striped","hover","condensed"),
                full_width = FALSE, position = "left")
```

## 8.2 What Tucker Gets Right About Israel

```{r}
#| label: tbl-gets-right
#| tbl-cap: "Open-ended: What do you think Tucker Carlson gets right about Israel? (selected)"

gets_right_col <- fcol("^\\(15\\) What do you think Tucker Carlson gets right")[1]

df |>
  select(response = all_of(gets_right_col)) |>
  filter(!is.na(response), nchar(trimws(response)) > 5) |>
  slice_head(n = 12) |>
  mutate(response = str_trunc(response, 250)) |>
  rename(`Participant Response` = response) |>
  kbl() |>
  kable_styling(bootstrap_options = c("striped","hover","condensed"),
                full_width = TRUE) |>
  column_spec(1, width = "95%")
```

## 8.3 Post-Conversation Reflections

```{r}
#| label: tbl-post-conv
#| tbl-cap: "Did the conversation change how you think about Tucker Carlson or Israel? (Q22–Q23)"

conv_tc_col  <- fcol("^\\(22\\) Did anything in the conversation.*Tucker")[1]
conv_isr_col <- fcol("^\\(23\\) Did anything in the conversation.*Israel")[1]

q22 <- df |>
  select(response = all_of(conv_tc_col)) |>
  filter(!is.na(response), nchar(trimws(response)) > 5) |>
  slice_head(n = 6) |>
  mutate(Question = "Changed views on Tucker?", response = str_trunc(response, 200))

q23 <- df |>
  select(response = all_of(conv_isr_col)) |>
  filter(!is.na(response), nchar(trimws(response)) > 5) |>
  slice_head(n = 6) |>
  mutate(Question = "Changed views on Israel?", response = str_trunc(response, 200))

bind_rows(q22, q23) |>
  rename(`Participant Response` = response) |>
  select(Question, `Participant Response`) |>
  kbl() |>
  kable_styling(bootstrap_options = c("striped","hover","condensed"),
                full_width = TRUE) |>
  column_spec(1, width = "20%", bold = TRUE) |>
  column_spec(2, width = "75%")
```

---

# 9 Demographic Predictors of Israel-Related Attitudes

This section examines how Israel-related attitudes at baseline vary across key demographic and political subgroups. The Connect sample (n = `r n_complete`) is large enough to make these comparisons meaningful, though cell sizes for some racial/ethnic groups remain small.

The outcomes examined are the **four Israel policy items** (Q12) plus the three **feeling thermometers** (Q10) and the **four Tucker-on-Israel items** (Q11).

```{r}
#| label: demo-attitudes-prep

# Gather all Israel-related pre-treatment items with short labels
israel_cols <- c(
  fcol("^\\(10\\.[0-9]\\).*- Value$"),   # thermometers
  fcol("^\\(11\\.[0-9]\\).*- Value$"),   # Tucker on Israel
  fcol("^\\(12\\.[0-9]\\).*- Value$")    # Israel policy
)

israel_short <- c(
  "Israeli people (therm.)",
  "Jewish people (therm.)",
  "State of Israel (therm.)",
  "Commentary accurate & fair",
  "Asks right questions",
  "Too critical of Israel",
  "Understands Middle East",
  "US-Israel benefits US",
  "Israel right to exist",
  "Israel acts morally",
  "Reduce military aid"
)

# Build a long-format analysis frame
# Attach key demographic predictors to each row
analysis_df <- df_c |>
  mutate(
    age_num   = suppressWarnings(as.numeric(.data[[age_col]])),
    party     = .data[[party_col]],
    ideology  = .data[[ideo_col]],
    tc_freq   = .data[[tc_col]],
    race_grp  = case_when(
      grepl("White", .data[[race_col]], ignore.case = TRUE) ~ "White",
      TRUE ~ "Non-White"
    ),
    # Ordered ideology (numeric 1-5 for correlation)
    ideo_num  = case_when(
      ideology == "Very liberal"         ~ 1,
      ideology == "Somewhat liberal"     ~ 2,
      ideology == "Moderate"             ~ 3,
      ideology == "Somewhat conservative"~ 4,
      ideology == "Very conservative"    ~ 5,
      TRUE ~ NA_real_
    )
  ) |>
  select(age_num, party, ideology, ideo_num, tc_freq, race_grp,
         all_of(israel_cols)) |>
  rename_with(~israel_short, all_of(israel_cols))

# Collapse small party categories
analysis_df <- analysis_df |>
  mutate(party3 = case_when(
    party == "Republican"   ~ "Republican",
    party == "Democrat"     ~ "Democrat",
    party %in% c("Independent", "Something else", "Prefer not to say") ~ "Ind./Other",
    TRUE ~ NA_character_
  ))

# Helper: group means table
group_means_tbl <- function(data, group_var, items, caption = NULL) {
  data |>
    filter(!is.na(.data[[group_var]])) |>
    group_by(Group = .data[[group_var]]) |>
    summarise(
      n = n(),
      across(all_of(items), ~round(mean(.x, na.rm = TRUE), 1)),
      .groups = "drop"
    ) |>
    kbl(caption = caption) |>
    kable_styling(bootstrap_options = c("striped","hover","condensed"),
                  full_width = FALSE, position = "left") |>
    footnote(general = "All scales 0–100.", general_title = "")
}
```

## 9.1 Israel Attitudes by Political Party

```{r}
#| label: fig-party-israel
#| fig-height: 7
#| fig-cap: "Mean Israel-related attitude scores by party affiliation (0–100 scales)"

party_long <- analysis_df |>
  filter(!is.na(party3)) |>
  pivot_longer(cols = all_of(israel_short), names_to = "item", values_to = "value") |>
  filter(!is.na(value)) |>
  group_by(party3, item) |>
  summarise(
    M  = mean(value),
    SE = sd(value) / sqrt(n()),
    n  = n(),
    .groups = "drop"
  ) |>
  mutate(
    item   = fct_rev(factor(item, levels = israel_short)),
    party3 = factor(party3, levels = c("Republican","Ind./Other","Democrat"))
  )

ggplot(party_long, aes(x = M, y = item, color = party3, shape = party3)) +
  geom_errorbarh(aes(xmin = M - 1.96 * SE, xmax = M + 1.96 * SE),
                 height = 0.3, position = position_dodge(0.6)) +
  geom_point(size = 3, position = position_dodge(0.6)) +
  scale_color_manual(
    values = c("Republican" = "#d7191c", "Ind./Other" = "#756bb1", "Democrat" = "#2c7bb6"),
    name = NULL
  ) +
  scale_shape_manual(values = c(16, 17, 15), name = NULL) +
  scale_x_continuous(limits = c(0, 100), breaks = seq(0, 100, 25)) +
  geom_vline(xintercept = 50, linetype = "dashed", color = "grey60") +
  labs(
    title    = "Israel-Related Attitudes by Party",
    subtitle = "Points = group mean; bars = 95% CI",
    x = "Mean Score (0–100)", y = NULL
  ) +
  theme_report() +
  theme(legend.position = "top")
```

```{r}
#| label: tbl-party-israel
#| tbl-cap: "Mean Israel-related attitude scores by party (0–100)"

group_means_tbl(analysis_df, "party3", israel_short,
                caption = "Israel-Related Attitudes by Party (0–100)")
```

```{r}
#| label: tbl-party-anova
#| tbl-cap: "One-way ANOVA: party differences on each Israel attitude item"

anova_results <- map_dfr(israel_short, function(item) {
  d   <- analysis_df |> filter(!is.na(party3), !is.na(.data[[item]]))
  aov_res <- aov(reformulate("party3", response = item), data = d)
  sm  <- summary(aov_res)[[1]]
  tibble(
    Item    = item,
    F       = round(sm[["F value"]][1], 2),
    df_b    = sm[["Df"]][1],
    df_w    = sm[["Df"]][2],
    p       = sm[["Pr(>F)"]][1],
    sig     = sig_star(sm[["Pr(>F)"]][1])
  )
})

anova_results |>
  mutate(p = paste0(format(round(p, 3), nsmall = 3), " ", sig)) |>
  select(-sig) |>
  rename(`F stat` = F, `df (between)` = df_b, `df (within)` = df_w) |>
  kbl(caption = "One-Way ANOVA: Party Group Differences") |>
  kable_styling(bootstrap_options = c("striped","hover","condensed"),
                full_width = FALSE, position = "left") |>
  footnote(general = "† p<.10, * p<.05, ** p<.01, *** p<.001.", general_title = "")
```

## 9.2 Israel Attitudes by Political Ideology

```{r}
#| label: fig-ideology-israel
#| fig-height: 7
#| fig-cap: "Mean Israel-related scores by ideology (ordered from liberal to conservative)"

ideo_order <- c("Very liberal","Somewhat liberal","Moderate",
                "Somewhat conservative","Very conservative")

ideo_long <- analysis_df |>
  filter(!is.na(ideology)) |>
  pivot_longer(cols = all_of(israel_short), names_to = "item", values_to = "value") |>
  filter(!is.na(value)) |>
  group_by(ideology, item) |>
  summarise(M = mean(value), SE = sd(value)/sqrt(n()), .groups = "drop") |>
  mutate(
    item     = fct_rev(factor(item, levels = israel_short)),
    ideology = factor(ideology, levels = ideo_order)
  )

ggplot(ideo_long, aes(x = M, y = item, color = ideology, shape = ideology)) +
  geom_errorbarh(aes(xmin = M - 1.96*SE, xmax = M + 1.96*SE),
                 height = 0.25, position = position_dodge(0.7)) +
  geom_point(size = 2.5, position = position_dodge(0.7)) +
  scale_color_manual(
    values = c("#2166ac","#74add1","#ffffbf","#f46d43","#d73027"),
    name = NULL
  ) +
  scale_shape_manual(values = c(16,17,15,18,8), name = NULL) +
  scale_x_continuous(limits = c(0, 100), breaks = seq(0, 100, 25)) +
  geom_vline(xintercept = 50, linetype = "dashed", color = "grey60") +
  labs(
    title    = "Israel-Related Attitudes by Ideology",
    subtitle = "Points = group mean; bars = 95% CI",
    x = "Mean Score (0–100)", y = NULL
  ) +
  theme_report() +
  theme(legend.position = "top",
        legend.text = element_text(size = 9))
```

```{r}
#| label: tbl-ideology-corr
#| tbl-cap: "Pearson correlations: ideology (1=Very liberal → 5=Very conservative) with Israel attitudes"

corr_ideo <- map_dfr(israel_short, function(item) {
  d <- analysis_df |> filter(!is.na(ideo_num), !is.na(.data[[item]]))
  ct <- cor.test(d$ideo_num, d[[item]])
  tibble(
    Item = item,
    r    = round(ct$estimate, 2),
    p    = ct$p.value,
    sig  = sig_star(ct$p.value),
    n    = nrow(d)
  )
})

corr_ideo |>
  mutate(p = paste0(format(round(p, 3), nsmall = 3), " ", sig)) |>
  select(-sig) |>
  kbl(caption = "Ideology–Attitude Correlations (ideology coded 1=Very liberal → 5=Very conservative)") |>
  kable_styling(bootstrap_options = c("striped","hover","condensed"),
                full_width = FALSE, position = "left") |>
  footnote(general = "Positive r = more conservative ideology associated with higher score. † p<.10, * p<.05, ** p<.01, *** p<.001.", general_title = "")
```

## 9.3 Israel Attitudes by Viewing Frequency

```{r}
#| label: fig-tc-freq-israel
#| fig-height: 5
#| fig-cap: "Mean Israel-related scores: regular vs. occasional Tucker Carlson viewers"

# Shorten TC labels
tc_recode <- c(
  "I listen to or watch his content regularly and generally agree with his views"    = "Regular viewer",
  "I listen to or watch his content occasionally and generally agree with his views" = "Occasional viewer"
)

tcfreq_long <- analysis_df |>
  mutate(tc_short = recode(tc_freq, !!!tc_recode)) |>
  filter(!is.na(tc_short)) |>
  pivot_longer(cols = all_of(israel_short), names_to = "item", values_to = "value") |>
  filter(!is.na(value)) |>
  group_by(tc_short, item) |>
  summarise(M = mean(value), SE = sd(value)/sqrt(n()), n = n(), .groups = "drop") |>
  mutate(item = fct_rev(factor(item, levels = israel_short)))

ggplot(tcfreq_long, aes(x = M, y = item, color = tc_short, shape = tc_short)) +
  geom_errorbarh(aes(xmin = M - 1.96*SE, xmax = M + 1.96*SE),
                 height = 0.3, position = position_dodge(0.5)) +
  geom_point(size = 3, position = position_dodge(0.5)) +
  scale_color_manual(values = c("#d7191c","#2c7bb6"), name = NULL) +
  scale_shape_manual(values = c(16, 17), name = NULL) +
  scale_x_continuous(limits = c(0, 100), breaks = seq(0, 100, 25)) +
  geom_vline(xintercept = 50, linetype = "dashed", color = "grey60") +
  labs(
    title    = "Israel Attitudes by Carlson Viewing Frequency",
    subtitle = "Points = group mean; bars = 95% CI",
    x = "Mean Score (0–100)", y = NULL
  ) +
  theme_report() +
  theme(legend.position = "top")
```

## 9.4 Correlations with Age

```{r}
#| label: tbl-age-corr
#| tbl-cap: "Pearson correlations: age with Israel-related attitudes"

corr_age <- map_dfr(israel_short, function(item) {
  d  <- analysis_df |> filter(!is.na(age_num), !is.na(.data[[item]]))
  ct <- cor.test(d$age_num, d[[item]])
  tibble(
    Item = item,
    r    = round(ct$estimate, 2),
    p    = ct$p.value,
    sig  = sig_star(ct$p.value),
    n    = nrow(d)
  )
})

corr_age |>
  mutate(p = paste0(format(round(p, 3), nsmall = 3), " ", sig)) |>
  select(-sig) |>
  kbl(caption = "Age–Attitude Correlations") |>
  kable_styling(bootstrap_options = c("striped","hover","condensed"),
                full_width = FALSE, position = "left") |>
  footnote(general = "Positive r = older respondents score higher. † p<.10, * p<.05, ** p<.01, *** p<.001.", general_title = "")
```

## 9.5 Multivariate Regression

OLS regression predicting each Israel attitude from party, ideology, age, and race simultaneously. Reference category: Republican (party), Very conservative (ideology), White (race).

```{r}
#| label: tbl-regression
#| tbl-cap: "OLS regression coefficients: demographic predictors of Israel attitudes"

reg_df <- analysis_df |>
  mutate(
    party3   = factor(party3,   levels = c("Republican","Ind./Other","Democrat")),
    ideology = factor(ideology, levels = ideo_order),
    race_grp = factor(race_grp, levels = c("White","Non-White"))
  )

# Run one regression per outcome; extract key coefficients
reg_results <- map_dfr(israel_short, function(item) {
  fml <- reformulate(c("party3", "ideology", "age_num", "race_grp"), response = item)
  m   <- lm(fml, data = reg_df)
  sm  <- summary(m)
  coefs <- coef(sm)
  se    <- coefs[, "Std. Error"]
  pval  <- coefs[, "Pr(>|t|)"]
  est   <- coefs[, "Estimate"]
  tibble(
    Item        = item,
    `Ind./Other`= paste0(round(est["party3Ind./Other"], 1), " ", sig_star(pval["party3Ind./Other"])),
    Democrat    = paste0(round(est["party3Democrat"],    1), " ", sig_star(pval["party3Democrat"])),
    `Smwt. lib.`= paste0(round(est["ideologySomewhat liberal"],    1), " ", sig_star(pval["ideologySomewhat liberal"])),
    Moderate    = paste0(round(est["ideologyModerate"],            1), " ", sig_star(pval["ideologyModerate"])),
    `Smwt. con.`= paste0(round(est["ideologySomewhat conservative"],1)," ", sig_star(pval["ideologySomewhat conservative"])),
    Age         = paste0(round(est["age_num"],                     2), " ", sig_star(pval["age_num"])),
    `Non-White` = paste0(round(est["race_grpNon-White"],           1), " ", sig_star(pval["race_grpNon-White"])),
    R2          = round(sm$r.squared, 2)
  )
})

reg_results |>
  kbl(caption = "OLS Regression: Demographic Predictors (ref: Republican, Very conservative, White)") |>
  kable_styling(bootstrap_options = c("striped","hover","condensed"),
                full_width = TRUE) |>
  add_header_above(c(" " = 1, "Party (ref = Republican)" = 2,
                     "Ideology (ref = Very conservative)" = 3,
                     " " = 1, " " = 1, " " = 1)) |>
  footnote(general = "Coefficients = unstandardized B. † p<.10, * p<.05, ** p<.01, *** p<.001. n per model ≈ 85–91.",
           general_title = "")
```

---

# 10 Key Findings

```{r}
#| label: tbl-summary
#| tbl-cap: "Summary of principal quantitative findings — Connect sample"

tibble(
  Finding = c(
    "Sample profile",
    "Political composition",
    "Biggest pre/post effect",
    "Second strongest effect",
    "Carlson factual credibility",
    "Core Israel policy beliefs",
    "Feeling thermometers",
    "Cluster structure"
  ),
  Result = c(
    paste0("n = ", n_complete, " completed; ", n_total, " total; Connect panel (CloudResearch)"),
    "Panel-provided party variable reflects Connect's broader recruitment pool — compare to 100% Republican in PrimePanels",
    "See forest plot — largest significant pre/post effect across 19 items",
    "See forest plot — second largest significant effect",
    "Monitor direction of change in credibility subscales",
    "Core Israel legitimacy and thermometer items expected to resist change",
    paste0("Israeli people M = ", filter(therm_summary, item=="Israeli People")$M,
           "; Jewish people M = ", filter(therm_summary, item=="Jewish People")$M,
           "; State of Israel M = ", filter(therm_summary, item=="State of Israel")$M),
    paste0("k = ", best_k, " clusters identified via silhouette analysis")
  )
) |>
  kbl(escape = FALSE) |>
  kable_styling(bootstrap_options = c("striped","hover","condensed"),
                full_width = TRUE) |>
  column_spec(1, bold = TRUE, width = "28%") |>
  column_spec(2, width = "68%")
```

---

# Appendix: Technical Notes

**Data source:** CloudResearch Connect panel; participants pre-screened as Tucker Carlson viewers.

**Demographic variables:** Age, sex, gender, race, ethnicity, education, party, and income are panel-provided by Connect at the time of recruitment. Political ideology was asked in-survey (Q29).

**Question numbering:** Post-treatment batteries are Q17–Q21 in Connect (vs. Q18–Q22 in PrimePanels). Post-conversation reflections are Q22–Q23 (vs. Q23–Q24 in PrimePanels).

**Statistical tests:** Paired two-sided t-tests on row-matched pre/post observations. Effect size reported as Cohen's *d* (mean difference / SD of differences). All p-values are two-sided.

**Clustering:** K-means (25 random starts, 100 max iterations); missing values median-imputed; variables scaled 0–1; optimal k by mean silhouette score.

```{r}
#| label: session-info
#| echo: true
#| code-fold: true
#| code-summary: "Session Info"

sessionInfo()
```
